{% set action = action ?? path('app_verify_email_resend') %}
{% set csrfToken = csrfToken ?? csrf_token('verify_email_resend') %}
{% set errors = errors ?? [] %}
{% set prefill = prefill ?? {} %}
{% set pending = pending ?? false %}

{% include 'components/alert.html.twig' with {
    messages: errors|filter(e => e.field is not defined or e.field is null)|map(e => e.message),
    title: 'Błąd',
    dataTestId: 'rate-limit-alert'
} %}

<form action="{{ action }}" method="post" class="space-y-4" data-turbo="false">
    <input type="hidden" name="_csrf_token" value="{{ csrfToken }}">

    {% include 'auth/components/form_field.html.twig' with {
        label: 'Adres email',
        type: 'email',
        name: 'email',
        id: 'verify-email',
        value: prefill.email ?? '',
        placeholder: 'your@email.com',
        required: true,
        autoFocus: true,
        error: (errors|filter(e => (e.field ?? null) == 'email')|first).message ?? null
    } %}

    <div class="flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3">
        <button type="submit"
                data-testid="resend-verification-button"
                class="inline-flex items-center justify-center rounded-xl px-4 sm:px-6 py-2.5 sm:py-3 text-sm sm:text-base font-semibold shadow-lg shadow-indigo-500/25 transition-all disabled:opacity-70 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-[#c7d2fe] focus:ring-offset-2 focus:ring-offset-white hover:translate-y-[-1px] active:translate-y-0.5 btn-auth-primary"
                {% if pending %}disabled{% endif %}>
            {% if pending %}
                <span class="mr-2 h-4 w-4 animate-spin rounded-full border-2 border-white/60 border-t-transparent"></span>
            {% endif %}
            <span class="sm:hidden">Wyślij link</span>
            <span class="hidden sm:inline">Wyślij ponownie link</span>
        </button>

        <div class="flex flex-col gap-1 text-center sm:text-right">
            <a href="/login" class="text-sm font-semibold text-indigo-600 hover:text-indigo-800 transition-colors">
                Wróć do logowania
            </a>
            <a href="/register" class="text-sm font-semibold text-indigo-600 hover:text-indigo-800 transition-colors">
                Zarejestruj się
            </a>
        </div>
    </div>
</form>


