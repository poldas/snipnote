{% extends 'auth/base_auth.html.twig' %}

{% block title %}Potwierdź email | Snipnote{% endblock %}

{% block auth_nav %}
    {% include 'auth/components/nav_links_auth.html.twig' with { nav: navSwitch ?? { href: '/login', label: 'Wróć do logowania' } } %}
{% endblock %}

{% block auth_hero %}
    {% include 'auth/components/hero_intro.html.twig' with {
        hero: hero ?? {
            headline: 'Sprawdź skrzynkę i potwierdź adres email',
            subcopy: 'Kliknij w link aktywacyjny, aby dokończyć rejestrację i korzystać z notatek.'
        },
        showCtas: false
    } %}
{% endblock %}

{% block auth_card %}
    {% set state = state ?? 'pending' %}
    {% set prefill = prefill ?? {} %}
    {% set errors = errors ?? [] %}
    {% set pending = pending ?? false %}
    {% set variant = variant ?? (state == 'invalid' ? 'warning' : 'info') %}
    {% set message = message ?? (state == 'invalid' ? 'Link wygasł lub jest nieprawidłowy.' : 'Wysłaliśmy link aktywacyjny na Twój email.') %}
    {% set steps = steps ?? [
        'Sprawdź skrzynkę oraz folder spam/oznaczone.',
        'Link jest jednorazowy i ma ograniczony czas ważności.',
        'Jeśli link nie działa, wyślij go ponownie poniżej.'
    ] %}
    {% set toneClasses = {
        'success': 'border-emerald-200 bg-emerald-50 text-emerald-800',
        'warning': 'border-amber-200 bg-amber-50 text-amber-900',
        'info': 'border-indigo-100 bg-indigo-50 text-indigo-900'
    }[variant] ?? 'border-indigo-100 bg-indigo-50 text-indigo-900' %}
    {% set stepsTextClasses = {
        'success': 'text-emerald-800',
        'warning': 'text-amber-900',
        'info': 'text-indigo-800'
    }[variant] ?? 'text-indigo-800' %}

    {% embed 'auth/components/auth_card.html.twig' with {
        title: 'Potwierdź swój adres email',
        subtitle: 'Bez aktywacji nie będziemy mogli udostępniać Twoich notatek.',
        pending: pending
    } %}
        {% block auth_card_body %}
            <div class="space-y-4">
                <div class="rounded-xl border {{ toneClasses }} px-4 py-3">
                    <p class="text-sm font-semibold">{{ message }}</p>
                    {% if steps is not empty %}
                        <ul class="mt-2 text-sm space-y-1 {{ stepsTextClasses }}">
                            {% for item in steps %}
                                <li>• {{ item }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>

                {% include 'auth/components/verify_resend_form.html.twig' with {
                    action: action ?? path('app_verify_email_resend'),
                    prefill: prefill,
                    errors: errors,
                    pending: pending
                } %}
            </div>
        {% endblock %}
    {% endembed %}
{% endblock %}


