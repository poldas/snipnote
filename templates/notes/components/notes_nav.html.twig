{#
  NotesNav Component
  Unified navigation for Dashboard, Edit, and New Note pages.
  Props:
    - subtitle (string)
    - backUrl (string, optional)
    - showAddBtn (bool, optional)
    - currentUserEmail (string)
#}
{% set subtitle = subtitle ?? 'Notatki' %}
{% set showAddBtn = showAddBtn ?? false %}

<div class="sticky top-0 z-40 bg-white/85 backdrop-blur-2xl border-b border-white/30 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 py-3 sm:py-4">
        <header class="flex items-center justify-between gap-4">
            <div class="flex items-center gap-4">
                {% include 'components/logo.html.twig' with {
                    subtitle: subtitle,
                    href: '/notes'
                } %}
            </div>
            
            <div class="flex items-center gap-2 sm:gap-4">
                {% if backUrl is defined and backUrl %}
                    <a href="{{ backUrl }}" class="px-3 sm:px-4 py-2 rounded-xl bg-white/60 text-indigo-600 hover:bg-white/90 hover:-translate-y-0.5 hover:shadow-md hover:border-indigo-300 backdrop-blur-sm border border-indigo-200/50 transition-all text-xs sm:text-sm font-bold shadow-sm">
                        <span class="sm:hidden">‚Üê</span>
                        <span class="hidden sm:inline">‚Üê Dashboard</span>
                    </a>
                {% endif %}

                {% if showAddBtn %}
                    <button type="button"
                            onclick="window.location.href='/notes/new'"
                            class="inline-flex items-center gap-2 px-3 sm:px-5 py-2 btn-auth-primary text-white rounded-xl font-bold shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all text-xs sm:text-sm">
                        <span class="text-lg">+</span>
                        <span class="hidden xs:inline">Dodaj notatkƒô</span>
                    </button>
                {% endif %}

                {# User Label & Logout (Desktop) #}
                <div class="hidden md:flex items-center gap-3">
                    <a href="{{ path('public_catalog_index', {'uuid': app.user.uuid}) }}" 
                       class="text-xs sm:text-sm font-bold text-indigo-600 hover:text-indigo-800 transition-colors p-2"
                       data-testid="nav-public-catalog-link">
                        M√≥j Katalog
                    </a>
                    <div class="px-4 py-2 rounded-xl bg-white/60 text-indigo-600 border border-indigo-200/50 shadow-sm text-xs sm:text-sm font-bold truncate max-w-[200px]">
                        {{ currentUserEmail ?? 'u≈ºytkownik' }}
                    </div>
                    <form action="/logout" method="post" class="inline">
                        <input type="hidden" name="_csrf_token" value="{{ csrf_token('logout') }}">
                        <button type="submit" class="text-xs sm:text-sm font-bold text-indigo-600 hover:text-indigo-800 transition-colors p-2">
                            Wyloguj
                        </button>
                    </form>
                </div>

                {# Mobile Menu Toggle #}
                <button data-mobile-menu-toggle class="md:hidden p-2 text-indigo-600 hover:bg-indigo-50 rounded-xl transition-colors" aria-label="Menu">
                    <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>
        </header>

        {# Mobile Menu Dropdown #}
        <div data-mobile-menu class="hidden md:hidden pt-4 pb-2 border-t border-indigo-50 mt-3 animate-fade-in">
            <div class="flex flex-col gap-4">
                <div class="px-2">
                    <a href="{{ path('public_catalog_index', {'uuid': app.user.uuid}) }}" 
                       class="w-full text-left px-2 py-3 text-sm font-black text-indigo-600 hover:bg-indigo-50 rounded-xl transition-colors flex items-center gap-2">
                        <span>üë§</span> M√≥j Katalog
                    </a>
                    <p class="text-[10px] font-black text-indigo-400 uppercase tracking-[0.2em] mb-2 mt-4">Zalogowany jako</p>
                    <div class="px-4 py-2 rounded-xl bg-white/60 text-indigo-600 border border-indigo-200/50 shadow-sm text-sm font-bold truncate">
                        {{ currentUserEmail ?? 'u≈ºytkownik' }}
                    </div>
                </div>
                <form action="/logout" method="post" class="w-full">
                    <input type="hidden" name="_csrf_token" value="{{ csrf_token('logout') }}">
                    <button type="submit" class="w-full text-left px-2 py-3 text-sm font-black text-rose-600 hover:bg-rose-50 rounded-xl transition-colors flex items-center gap-2">
                        <span>üö™</span> Wyloguj siƒô
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
